# LSTM Model

Use prepared data (Data_scaled) to train LSTM model.

## Imports and Setup


```python
import pandas as pd
import numpy as np
import hvplot.pandas
from sklearn.metrics import mean_absolute_error, mean_squared_error # Packages for measuring model performance / errors
from keras.models import Sequential # Deep learning library, used for neural networks
from keras.layers import LSTM, Dense, Dropout # Deep learning classes for recurrent and regular densely-connected layers
from keras.callbacks import EarlyStopping # EarlyStopping during model training

import joblib

from pathlib import Path

import matplotlib.pyplot as plt
```










```python
np.set_printoptions(edgeitems=30, linewidth=100000, formatter=dict(float=lambda x: "%.3f" %x))

root_dir = Path('c:/projects/nrel-presentation/')
```

## Functions


```python
def prep_ts_data(Data, back, fore, train_split_fraction=0.8, verbose=False):
    """
    Prepare data for LSTM
    Data: dataframe with the data we want to predict in column 0
    back: how many timesteps backward to look
    fore: how many timesteps to predict
    train_split_fraction: what fraction (bet 0.01 and 0.99) to take for training data
    
    Returns:
        x_train: training X
        y_train: training y
        x_test: testing X
        y_test: testing y
    """
    nrows = Data.shape[0]
    dimensions = Data.shape[1]
    batch_size = nrows - back - fore + 1

    # instantiate big matrix M
    M = np.empty((batch_size, back+fore, dimensions))
    print('starting')
    for i in range(0, batch_size):
        if verbose:
            print('batch: {} of {}'.format(i+1, batch_size))
        M[i, :, :] = Data.iloc[i: (i+back+fore)]
        
    # slice M into X and Y
    X = M[:, 0:back, :]
    Y = M[:, back:(back+fore), 0]
    
    # slice X and Y into training and testing
    num_train = int(np.ceil(batch_size * train_split_fraction))
    x_train = X[:num_train, :, :]
    y_train = Y[:num_train, :]
    x_test = X[num_train:, :, :]
    y_test = Y[num_train:, :]
    print('x_train : {}'.format(x_train.shape))
    print('y_train : {}'.format(y_train.shape))
    print('x_test : {}'.format(x_test.shape))
    print('y_test : {}'.format(y_test.shape))
    print('done')

    return(x_train, y_train, x_test, y_test)
```

## Load Data


```python
Data = pd.read_parquet(root_dir / 'data' / 'processed' / 'Data_scaled.pq')
```


```python
Data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lane_vehicle_speed</th>
      <th>lane_vehicle_count</th>
      <th>occupancy</th>
      <th>ds_lane_vehicle_speed</th>
      <th>ds_lane_vehicle_count</th>
      <th>ds_occupancy</th>
      <th>hod</th>
      <th>sin_hod</th>
      <th>cos_hod</th>
      <th>is_dow_2</th>
      <th>is_dow_3</th>
      <th>is_dow_4</th>
      <th>is_dow_5</th>
      <th>is_dow_6</th>
      <th>sin_doy</th>
      <th>cos_doy</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-26 20:00:00</th>
      <td>0.647001</td>
      <td>0.159304</td>
      <td>0.126002</td>
      <td>0.491900</td>
      <td>0.184578</td>
      <td>0.071225</td>
      <td>0.869565</td>
      <td>0.146447</td>
      <td>0.853553</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2021-10-26 20:10:00</th>
      <td>0.644248</td>
      <td>0.244980</td>
      <td>0.134021</td>
      <td>0.563328</td>
      <td>0.240437</td>
      <td>0.076923</td>
      <td>0.869565</td>
      <td>0.146447</td>
      <td>0.853553</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2021-10-26 20:20:00</th>
      <td>0.732743</td>
      <td>0.144578</td>
      <td>0.061856</td>
      <td>0.640648</td>
      <td>0.174863</td>
      <td>0.051282</td>
      <td>0.869565</td>
      <td>0.146447</td>
      <td>0.853553</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2021-10-26 20:30:00</th>
      <td>0.520354</td>
      <td>0.148594</td>
      <td>0.082474</td>
      <td>0.548355</td>
      <td>0.163934</td>
      <td>0.064103</td>
      <td>0.869565</td>
      <td>0.146447</td>
      <td>0.853553</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2021-10-26 20:40:00</th>
      <td>0.619469</td>
      <td>0.163766</td>
      <td>0.080183</td>
      <td>0.631811</td>
      <td>0.142077</td>
      <td>0.042735</td>
      <td>0.869565</td>
      <td>0.146447</td>
      <td>0.853553</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
Data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    DatetimeIndex: 652 entries, 2021-10-26 20:00:00 to 2021-10-31 08:30:00
    Data columns (total 16 columns):
     #   Column                 Non-Null Count  Dtype  
    ---  ------                 --------------  -----  
     0   lane_vehicle_speed     652 non-null    float64
     1   lane_vehicle_count     652 non-null    float64
     2   occupancy              652 non-null    float64
     3   ds_lane_vehicle_speed  652 non-null    float64
     4   ds_lane_vehicle_count  652 non-null    float64
     5   ds_occupancy           652 non-null    float64
     6   hod                    652 non-null    float64
     7   sin_hod                652 non-null    float64
     8   cos_hod                652 non-null    float64
     9   is_dow_2               652 non-null    float64
     10  is_dow_3               652 non-null    float64
     11  is_dow_4               652 non-null    float64
     12  is_dow_5               652 non-null    float64
     13  is_dow_6               652 non-null    float64
     14  sin_doy                652 non-null    float64
     15  cos_doy                652 non-null    float64
    dtypes: float64(16)
    memory usage: 86.6 KB
    


```python
# split data into train and test
# use previous 60 values to predict the next 15
back = 6
fore = 2
x_train, y_train, x_test, y_test = prep_ts_data(Data, back=back, fore=fore)
```

    starting
    x_train : (516, 6, 16)
    y_train : (516, 2)
    x_test : (129, 6, 16)
    y_test : (129, 2)
    done
    


```python
x_train[0, :, :]
```




    array([[0.647, 0.159, 0.126, 0.492, 0.185, 0.071, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
           [0.644, 0.245, 0.134, 0.563, 0.240, 0.077, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
           [0.733, 0.145, 0.062, 0.641, 0.175, 0.051, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
           [0.520, 0.149, 0.082, 0.548, 0.164, 0.064, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
           [0.619, 0.164, 0.080, 0.632, 0.142, 0.043, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
           [0.793, 0.149, 0.093, 0.546, 0.180, 0.064, 0.870, 0.146, 0.854, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000]])



## Build Model


```python
from keras.models import Sequential
from keras.layers import LSTM, Dense

# Configure the neural network model
LSTMmodel = Sequential()

# Model with n_neurons = inputshape Timestamps, each with x_train.shape[2] variables
n_neurons = x_train.shape[1] * x_train.shape[2]
dense_neurons = y_train.shape[1]

print(n_neurons, x_train.shape[1], x_train.shape[2])
LSTMmodel.add(LSTM(n_neurons, return_sequences=True, input_shape=(x_train.shape[1], x_train.shape[2]))) 
LSTMmodel.add(LSTM(n_neurons, return_sequences=True))
LSTMmodel.add(LSTM(n_neurons, return_sequences=True))
LSTMmodel.add(LSTM(n_neurons, return_sequences=False))
LSTMmodel.add(Dense(dense_neurons))

# Compile the model
LSTMmodel.compile(optimizer='adam', loss='mse')
```

    96 6 16
    2
    


```python
LSTMmodel.layers
```




    [<keras.layers.recurrent_v2.LSTM at 0x1d2e6658610>,
     <keras.layers.recurrent_v2.LSTM at 0x1d2e6658640>,
     <keras.layers.recurrent_v2.LSTM at 0x1d2e65a9f70>,
     <keras.layers.recurrent_v2.LSTM at 0x1d2e68c3a30>,
     <keras.layers.core.Dense at 0x1d2e68a3850>]



# Train Model


```python
# Training the model
epochs = 200
batch_size = 16
early_stop = EarlyStopping(monitor='loss', patience=5, verbose=1)
history = LSTMmodel.fit(x_train, y_train, 
                    batch_size=batch_size, 
                    epochs=epochs,
                    validation_data=(x_test, y_test),
                    verbose=2
                   )
```

    Epoch 1/200
    33/33 - 9s - loss: 0.0661 - val_loss: 0.0137
    Epoch 2/200
    33/33 - 0s - loss: 0.0119 - val_loss: 0.0121
    Epoch 3/200
    33/33 - 0s - loss: 0.0108 - val_loss: 0.0117
    Epoch 4/200
    33/33 - 0s - loss: 0.0107 - val_loss: 0.0112
    Epoch 5/200
    33/33 - 0s - loss: 0.0103 - val_loss: 0.0116
    Epoch 6/200
    33/33 - 0s - loss: 0.0103 - val_loss: 0.0122
    Epoch 7/200
    33/33 - 0s - loss: 0.0109 - val_loss: 0.0118
    Epoch 8/200
    33/33 - 0s - loss: 0.0108 - val_loss: 0.0114
    Epoch 9/200
    33/33 - 0s - loss: 0.0105 - val_loss: 0.0117
    Epoch 10/200
    33/33 - 0s - loss: 0.0100 - val_loss: 0.0116
    Epoch 11/200
    33/33 - 0s - loss: 0.0110 - val_loss: 0.0142
    Epoch 12/200
    33/33 - 0s - loss: 0.0104 - val_loss: 0.0115
    Epoch 13/200
    33/33 - 0s - loss: 0.0104 - val_loss: 0.0115
    Epoch 14/200
    33/33 - 0s - loss: 0.0099 - val_loss: 0.0116
    Epoch 15/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0115
    Epoch 16/200
    33/33 - 0s - loss: 0.0099 - val_loss: 0.0119
    Epoch 17/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0116
    Epoch 18/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0115
    Epoch 19/200
    33/33 - 0s - loss: 0.0097 - val_loss: 0.0117
    Epoch 20/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0116
    Epoch 21/200
    33/33 - 0s - loss: 0.0102 - val_loss: 0.0135
    Epoch 22/200
    33/33 - 0s - loss: 0.0097 - val_loss: 0.0132
    Epoch 23/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0114
    Epoch 24/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0118
    Epoch 25/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0116
    Epoch 26/200
    33/33 - 0s - loss: 0.0099 - val_loss: 0.0125
    Epoch 27/200
    33/33 - 0s - loss: 0.0100 - val_loss: 0.0115
    Epoch 28/200
    33/33 - 0s - loss: 0.0098 - val_loss: 0.0121
    Epoch 29/200
    33/33 - 0s - loss: 0.0097 - val_loss: 0.0123
    Epoch 30/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0115
    Epoch 31/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0126
    Epoch 32/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0121
    Epoch 33/200
    33/33 - 0s - loss: 0.0099 - val_loss: 0.0139
    Epoch 34/200
    33/33 - 0s - loss: 0.0104 - val_loss: 0.0118
    Epoch 35/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0125
    Epoch 36/200
    33/33 - 0s - loss: 0.0094 - val_loss: 0.0124
    Epoch 37/200
    33/33 - 0s - loss: 0.0091 - val_loss: 0.0125
    Epoch 38/200
    33/33 - 0s - loss: 0.0096 - val_loss: 0.0120
    Epoch 39/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0125
    Epoch 40/200
    33/33 - 0s - loss: 0.0099 - val_loss: 0.0141
    Epoch 41/200
    33/33 - 0s - loss: 0.0094 - val_loss: 0.0140
    Epoch 42/200
    33/33 - 0s - loss: 0.0093 - val_loss: 0.0130
    Epoch 43/200
    33/33 - 0s - loss: 0.0092 - val_loss: 0.0139
    Epoch 44/200
    33/33 - 0s - loss: 0.0092 - val_loss: 0.0153
    Epoch 45/200
    33/33 - 0s - loss: 0.0091 - val_loss: 0.0170
    Epoch 46/200
    33/33 - 0s - loss: 0.0094 - val_loss: 0.0150
    Epoch 47/200
    33/33 - 0s - loss: 0.0092 - val_loss: 0.0155
    Epoch 48/200
    33/33 - 0s - loss: 0.0091 - val_loss: 0.0125
    Epoch 49/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0122
    Epoch 50/200
    33/33 - 0s - loss: 0.0093 - val_loss: 0.0156
    Epoch 51/200
    33/33 - 0s - loss: 0.0093 - val_loss: 0.0140
    Epoch 52/200
    33/33 - 0s - loss: 0.0090 - val_loss: 0.0137
    Epoch 53/200
    33/33 - 0s - loss: 0.0092 - val_loss: 0.0124
    Epoch 54/200
    33/33 - 0s - loss: 0.0091 - val_loss: 0.0148
    Epoch 55/200
    33/33 - 0s - loss: 0.0089 - val_loss: 0.0171
    Epoch 56/200
    33/33 - 0s - loss: 0.0088 - val_loss: 0.0156
    Epoch 57/200
    33/33 - 0s - loss: 0.0090 - val_loss: 0.0120
    Epoch 58/200
    33/33 - 0s - loss: 0.0087 - val_loss: 0.0148
    Epoch 59/200
    33/33 - 0s - loss: 0.0087 - val_loss: 0.0170
    Epoch 60/200
    33/33 - 0s - loss: 0.0085 - val_loss: 0.0155
    Epoch 61/200
    33/33 - 0s - loss: 0.0095 - val_loss: 0.0124
    Epoch 62/200
    33/33 - 1s - loss: 0.0089 - val_loss: 0.0124
    Epoch 63/200
    33/33 - 1s - loss: 0.0088 - val_loss: 0.0179
    Epoch 64/200
    33/33 - 1s - loss: 0.0086 - val_loss: 0.0156
    Epoch 65/200
    33/33 - 0s - loss: 0.0083 - val_loss: 0.0132
    Epoch 66/200
    33/33 - 0s - loss: 0.0084 - val_loss: 0.0173
    Epoch 67/200
    33/33 - 1s - loss: 0.0086 - val_loss: 0.0173
    Epoch 68/200
    33/33 - 1s - loss: 0.0085 - val_loss: 0.0140
    Epoch 69/200
    33/33 - 0s - loss: 0.0083 - val_loss: 0.0142
    Epoch 70/200
    33/33 - 1s - loss: 0.0083 - val_loss: 0.0144
    Epoch 71/200
    33/33 - 1s - loss: 0.0085 - val_loss: 0.0186
    Epoch 72/200
    33/33 - 0s - loss: 0.0088 - val_loss: 0.0183
    Epoch 73/200
    33/33 - 1s - loss: 0.0084 - val_loss: 0.0142
    Epoch 74/200
    33/33 - 1s - loss: 0.0081 - val_loss: 0.0187
    Epoch 75/200
    33/33 - 1s - loss: 0.0086 - val_loss: 0.0171
    Epoch 76/200
    33/33 - 1s - loss: 0.0085 - val_loss: 0.0196
    Epoch 77/200
    33/33 - 1s - loss: 0.0083 - val_loss: 0.0196
    Epoch 78/200
    33/33 - 1s - loss: 0.0084 - val_loss: 0.0198
    Epoch 79/200
    33/33 - 1s - loss: 0.0083 - val_loss: 0.0153
    Epoch 80/200
    33/33 - 1s - loss: 0.0084 - val_loss: 0.0234
    Epoch 81/200
    33/33 - 1s - loss: 0.0088 - val_loss: 0.0154
    Epoch 82/200
    33/33 - 1s - loss: 0.0082 - val_loss: 0.0155
    Epoch 83/200
    33/33 - 1s - loss: 0.0082 - val_loss: 0.0169
    Epoch 84/200
    33/33 - 1s - loss: 0.0080 - val_loss: 0.0170
    Epoch 85/200
    33/33 - 1s - loss: 0.0083 - val_loss: 0.0211
    Epoch 86/200
    33/33 - 1s - loss: 0.0083 - val_loss: 0.0194
    Epoch 87/200
    33/33 - 1s - loss: 0.0080 - val_loss: 0.0169
    Epoch 88/200
    33/33 - 1s - loss: 0.0080 - val_loss: 0.0211
    Epoch 89/200
    33/33 - 1s - loss: 0.0082 - val_loss: 0.0169
    Epoch 90/200
    33/33 - 1s - loss: 0.0081 - val_loss: 0.0219
    Epoch 91/200
    33/33 - 1s - loss: 0.0079 - val_loss: 0.0161
    Epoch 92/200
    33/33 - 0s - loss: 0.0083 - val_loss: 0.0156
    Epoch 93/200
    33/33 - 1s - loss: 0.0086 - val_loss: 0.0207
    Epoch 94/200
    33/33 - 0s - loss: 0.0083 - val_loss: 0.0233
    Epoch 95/200
    33/33 - 1s - loss: 0.0080 - val_loss: 0.0195
    Epoch 96/200
    33/33 - 0s - loss: 0.0079 - val_loss: 0.0207
    Epoch 97/200
    33/33 - 1s - loss: 0.0079 - val_loss: 0.0224
    Epoch 98/200
    33/33 - 0s - loss: 0.0081 - val_loss: 0.0152
    Epoch 99/200
    33/33 - 1s - loss: 0.0090 - val_loss: 0.0155
    Epoch 100/200
    33/33 - 1s - loss: 0.0081 - val_loss: 0.0236
    Epoch 101/200
    33/33 - 0s - loss: 0.0080 - val_loss: 0.0135
    Epoch 102/200
    33/33 - 0s - loss: 0.0080 - val_loss: 0.0170
    Epoch 103/200
    33/33 - 0s - loss: 0.0080 - val_loss: 0.0181
    Epoch 104/200
    33/33 - 0s - loss: 0.0080 - val_loss: 0.0162
    Epoch 105/200
    33/33 - 0s - loss: 0.0085 - val_loss: 0.0206
    Epoch 106/200
    33/33 - 1s - loss: 0.0081 - val_loss: 0.0197
    Epoch 107/200
    33/33 - 1s - loss: 0.0081 - val_loss: 0.0159
    Epoch 108/200
    33/33 - 1s - loss: 0.0079 - val_loss: 0.0189
    Epoch 109/200
    33/33 - 1s - loss: 0.0077 - val_loss: 0.0198
    Epoch 110/200
    33/33 - 0s - loss: 0.0077 - val_loss: 0.0170
    Epoch 111/200
    33/33 - 0s - loss: 0.0077 - val_loss: 0.0178
    Epoch 112/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0194
    Epoch 113/200
    33/33 - 0s - loss: 0.0077 - val_loss: 0.0168
    Epoch 114/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0228
    Epoch 115/200
    33/33 - 0s - loss: 0.0078 - val_loss: 0.0168
    Epoch 116/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0162
    Epoch 117/200
    33/33 - 0s - loss: 0.0075 - val_loss: 0.0195
    Epoch 118/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0155
    Epoch 119/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0207
    Epoch 120/200
    33/33 - 0s - loss: 0.0074 - val_loss: 0.0195
    Epoch 121/200
    33/33 - 0s - loss: 0.0075 - val_loss: 0.0161
    Epoch 122/200
    33/33 - 1s - loss: 0.0077 - val_loss: 0.0195
    Epoch 123/200
    33/33 - 0s - loss: 0.0075 - val_loss: 0.0186
    Epoch 124/200
    33/33 - 0s - loss: 0.0075 - val_loss: 0.0183
    Epoch 125/200
    33/33 - 0s - loss: 0.0072 - val_loss: 0.0156
    Epoch 126/200
    33/33 - 0s - loss: 0.0073 - val_loss: 0.0195
    Epoch 127/200
    33/33 - 1s - loss: 0.0074 - val_loss: 0.0148
    Epoch 128/200
    33/33 - 1s - loss: 0.0078 - val_loss: 0.0150
    Epoch 129/200
    33/33 - 1s - loss: 0.0077 - val_loss: 0.0173
    Epoch 130/200
    33/33 - 1s - loss: 0.0076 - val_loss: 0.0165
    Epoch 131/200
    33/33 - 1s - loss: 0.0075 - val_loss: 0.0162
    Epoch 132/200
    33/33 - 1s - loss: 0.0074 - val_loss: 0.0170
    Epoch 133/200
    33/33 - 0s - loss: 0.0071 - val_loss: 0.0182
    Epoch 134/200
    33/33 - 0s - loss: 0.0076 - val_loss: 0.0150
    Epoch 135/200
    33/33 - 0s - loss: 0.0073 - val_loss: 0.0161
    Epoch 136/200
    33/33 - 0s - loss: 0.0077 - val_loss: 0.0175
    Epoch 137/200
    33/33 - 0s - loss: 0.0070 - val_loss: 0.0194
    Epoch 138/200
    33/33 - 0s - loss: 0.0071 - val_loss: 0.0167
    Epoch 139/200
    33/33 - 0s - loss: 0.0071 - val_loss: 0.0189
    Epoch 140/200
    33/33 - 1s - loss: 0.0074 - val_loss: 0.0167
    Epoch 141/200
    33/33 - 0s - loss: 0.0068 - val_loss: 0.0173
    Epoch 142/200
    33/33 - 0s - loss: 0.0069 - val_loss: 0.0169
    Epoch 143/200
    33/33 - 1s - loss: 0.0067 - val_loss: 0.0186
    Epoch 144/200
    33/33 - 1s - loss: 0.0066 - val_loss: 0.0141
    Epoch 145/200
    33/33 - 1s - loss: 0.0069 - val_loss: 0.0161
    Epoch 146/200
    33/33 - 1s - loss: 0.0067 - val_loss: 0.0169
    Epoch 147/200
    33/33 - 1s - loss: 0.0070 - val_loss: 0.0186
    Epoch 148/200
    33/33 - 1s - loss: 0.0067 - val_loss: 0.0175
    Epoch 149/200
    33/33 - 1s - loss: 0.0066 - val_loss: 0.0166
    Epoch 150/200
    33/33 - 1s - loss: 0.0066 - val_loss: 0.0174
    Epoch 151/200
    33/33 - 1s - loss: 0.0066 - val_loss: 0.0167
    Epoch 152/200
    33/33 - 0s - loss: 0.0068 - val_loss: 0.0145
    Epoch 153/200
    33/33 - 0s - loss: 0.0071 - val_loss: 0.0171
    Epoch 154/200
    33/33 - 0s - loss: 0.0066 - val_loss: 0.0168
    Epoch 155/200
    33/33 - 0s - loss: 0.0064 - val_loss: 0.0158
    Epoch 156/200
    33/33 - 0s - loss: 0.0062 - val_loss: 0.0193
    Epoch 157/200
    33/33 - 0s - loss: 0.0062 - val_loss: 0.0148
    Epoch 158/200
    33/33 - 0s - loss: 0.0066 - val_loss: 0.0143
    Epoch 159/200
    33/33 - 0s - loss: 0.0061 - val_loss: 0.0215
    Epoch 160/200
    33/33 - 0s - loss: 0.0063 - val_loss: 0.0175
    Epoch 161/200
    33/33 - 1s - loss: 0.0062 - val_loss: 0.0154
    Epoch 162/200
    33/33 - 0s - loss: 0.0058 - val_loss: 0.0184
    Epoch 163/200
    33/33 - 0s - loss: 0.0059 - val_loss: 0.0161
    Epoch 164/200
    33/33 - 0s - loss: 0.0061 - val_loss: 0.0158
    Epoch 165/200
    33/33 - 0s - loss: 0.0058 - val_loss: 0.0154
    Epoch 166/200
    33/33 - 0s - loss: 0.0058 - val_loss: 0.0172
    Epoch 167/200
    33/33 - 0s - loss: 0.0058 - val_loss: 0.0189
    Epoch 168/200
    33/33 - 0s - loss: 0.0062 - val_loss: 0.0179
    Epoch 169/200
    33/33 - 0s - loss: 0.0056 - val_loss: 0.0163
    Epoch 170/200
    33/33 - 0s - loss: 0.0056 - val_loss: 0.0185
    Epoch 171/200
    33/33 - 0s - loss: 0.0053 - val_loss: 0.0167
    Epoch 172/200
    33/33 - 0s - loss: 0.0054 - val_loss: 0.0199
    Epoch 173/200
    33/33 - 0s - loss: 0.0055 - val_loss: 0.0162
    Epoch 174/200
    33/33 - 0s - loss: 0.0053 - val_loss: 0.0160
    Epoch 175/200
    33/33 - 0s - loss: 0.0053 - val_loss: 0.0167
    Epoch 176/200
    33/33 - 0s - loss: 0.0054 - val_loss: 0.0200
    Epoch 177/200
    33/33 - 0s - loss: 0.0052 - val_loss: 0.0186
    Epoch 178/200
    33/33 - 1s - loss: 0.0049 - val_loss: 0.0172
    Epoch 179/200
    33/33 - 0s - loss: 0.0057 - val_loss: 0.0162
    Epoch 180/200
    33/33 - 1s - loss: 0.0053 - val_loss: 0.0185
    Epoch 181/200
    33/33 - 0s - loss: 0.0055 - val_loss: 0.0161
    Epoch 182/200
    33/33 - 0s - loss: 0.0049 - val_loss: 0.0187
    Epoch 183/200
    33/33 - 0s - loss: 0.0053 - val_loss: 0.0151
    Epoch 184/200
    33/33 - 0s - loss: 0.0052 - val_loss: 0.0155
    Epoch 185/200
    33/33 - 0s - loss: 0.0048 - val_loss: 0.0178
    Epoch 186/200
    33/33 - 0s - loss: 0.0049 - val_loss: 0.0154
    Epoch 187/200
    33/33 - 0s - loss: 0.0046 - val_loss: 0.0168
    Epoch 188/200
    33/33 - 0s - loss: 0.0047 - val_loss: 0.0158
    Epoch 189/200
    33/33 - 0s - loss: 0.0045 - val_loss: 0.0184
    Epoch 190/200
    33/33 - 0s - loss: 0.0044 - val_loss: 0.0175
    Epoch 191/200
    33/33 - 0s - loss: 0.0043 - val_loss: 0.0164
    Epoch 192/200
    33/33 - 0s - loss: 0.0045 - val_loss: 0.0163
    Epoch 193/200
    33/33 - 0s - loss: 0.0045 - val_loss: 0.0171
    Epoch 194/200
    33/33 - 0s - loss: 0.0043 - val_loss: 0.0163
    Epoch 195/200
    33/33 - 0s - loss: 0.0044 - val_loss: 0.0132
    Epoch 196/200
    33/33 - 0s - loss: 0.0040 - val_loss: 0.0174
    Epoch 197/200
    33/33 - 0s - loss: 0.0038 - val_loss: 0.0172
    Epoch 198/200
    33/33 - 0s - loss: 0.0038 - val_loss: 0.0165
    Epoch 199/200
    33/33 - 0s - loss: 0.0038 - val_loss: 0.0149
    Epoch 200/200
    33/33 - 0s - loss: 0.0039 - val_loss: 0.0149
    

## Save model


```python
#joblib.dump(LSTMmodel, root_dir / 'models' / 'LSTMmodel')
```

# Predictions


```python
y_test_predicted = LSTMmodel.predict(x_test)
```


```python
print(x_test.shape, y_test.shape, y_test_predicted.shape)
```

    (129, 6, 16) (129, 2) (129, 2)
    


```python
# assign timestamps
# test dataset is the last 20% of the data
# skip the first num_rows + back of y_train to start 
ts = Data.index[(y_train.shape[0] + back + 1):]
ts.shape
```




    (129,)




```python
# create dataframe of test and prediction
Results = pd.DataFrame({'y_test': y_test[:, 0], 'y_test_predicted_0': y_test_predicted[:, 0]}, index=ts)
Results['y_test_predicted_1'] = np.concatenate((np.array([np.nan]), y_test_predicted[:-1, 1]))
```


```python
Results
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_test</th>
      <th>y_test_predicted_0</th>
      <th>y_test_predicted_1</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-30 11:10:00</th>
      <td>0.598230</td>
      <td>0.446113</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2021-10-30 11:20:00</th>
      <td>0.523894</td>
      <td>0.456965</td>
      <td>0.485312</td>
    </tr>
    <tr>
      <th>2021-10-30 11:30:00</th>
      <td>0.548673</td>
      <td>0.422406</td>
      <td>0.461958</td>
    </tr>
    <tr>
      <th>2021-10-30 11:40:00</th>
      <td>0.555752</td>
      <td>0.405074</td>
      <td>0.446531</td>
    </tr>
    <tr>
      <th>2021-10-30 11:50:00</th>
      <td>0.566372</td>
      <td>0.418186</td>
      <td>0.464422</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-10-31 07:50:00</th>
      <td>0.569912</td>
      <td>0.526884</td>
      <td>0.560204</td>
    </tr>
    <tr>
      <th>2021-10-31 08:00:00</th>
      <td>0.529007</td>
      <td>0.509120</td>
      <td>0.553377</td>
    </tr>
    <tr>
      <th>2021-10-31 08:10:00</th>
      <td>0.527434</td>
      <td>0.553250</td>
      <td>0.587495</td>
    </tr>
    <tr>
      <th>2021-10-31 08:20:00</th>
      <td>0.594690</td>
      <td>0.555780</td>
      <td>0.595859</td>
    </tr>
    <tr>
      <th>2021-10-31 08:30:00</th>
      <td>0.580531</td>
      <td>0.541769</td>
      <td>0.584208</td>
    </tr>
  </tbody>
</table>
<p>129 rows × 3 columns</p>
</div>




```python
line_plot = Results.hvplot.line(y='y_test')
scatter_plot0 = Results.hvplot.scatter(y='y_test_predicted_0').opts(color='black', marker='o')
scatter_plot1 = Results.hvplot.scatter(y='y_test_predicted_1').opts(color='black', marker='o', alpha=0.5)
line_plot * scatter_plot0 * scatter_plot1
```






<div id='1002'>





  <div class="bk-root" id="21ca4dd2-f5e5-42a4-8159-59205a50d0a1" data-root-id="1002"></div>
</div>
<script type="application/javascript">(function(root) {
  function embed_document(root) {
    var docs_json = {"01fe59bb-f90e-4bed-96c7-ca0dd762c76c":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{"end":1635669000000.0,"reset_end":1635669000000.0,"reset_start":1635592200000.0,"start":1635592200000.0,"tags":[[["timestamp","timestamp",null]]]},"id":"1004","type":"Range1d"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer01876","sizing_mode":"stretch_width"},"id":"1003","type":"Spacer"},{"attributes":{"text_color":"black","text_font_size":"12pt"},"id":"1010","type":"Title"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1053"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test","@{y_test}"]]},"id":"1006","type":"HoverTool"},{"attributes":{},"id":"1041","type":"DatetimeTickFormatter"},{"attributes":{"children":[{"id":"1003"},{"id":"1009"},{"id":"1308"}],"margin":[0,0,0,0],"name":"Row01872","tags":["embedded"]},"id":"1002","type":"Row"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1071"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_predicted_1","@{y_test_predicted_1}"]]},"id":"1008","type":"HoverTool"},{"attributes":{"line_alpha":0.2,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test"}},"id":"1052","type":"Line"},{"attributes":{},"id":"1098","type":"UnionRenderers"},{"attributes":{"end":1.0745132743362829,"reset_end":1.0745132743362829,"reset_start":0.18035398230088495,"start":0.18035398230088495,"tags":[[["y_test","y_test",null]]]},"id":"1005","type":"Range1d"},{"attributes":{},"id":"1014","type":"LinearScale"},{"attributes":{},"id":"1043","type":"AllLabels"},{"attributes":{},"id":"1016","type":"LinearScale"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test"}},"id":"1050","type":"Line"},{"attributes":{"below":[{"id":"1018"}],"center":[{"id":"1021"},{"id":"1025"}],"height":300,"left":[{"id":"1022"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"1053"},{"id":"1062"},{"id":"1071"}],"sizing_mode":"fixed","title":{"id":"1010"},"toolbar":{"id":"1032"},"width":700,"x_range":{"id":"1004"},"x_scale":{"id":"1014"},"y_range":{"id":"1005"},"y_scale":{"id":"1016"}},"id":"1009","subtype":"Figure","type":"Plot"},{"attributes":{"axis_label":"timestamp","formatter":{"id":"1041"},"major_label_policy":{"id":"1043"},"ticker":{"id":"1019"}},"id":"1018","type":"DatetimeAxis"},{"attributes":{},"id":"1044","type":"BasicTickFormatter"},{"attributes":{},"id":"1046","type":"AllLabels"},{"attributes":{"num_minor_ticks":5,"tickers":[{"id":"1082"},{"id":"1083"},{"id":"1084"},{"id":"1085"},{"id":"1086"},{"id":"1087"},{"id":"1088"},{"id":"1089"},{"id":"1090"},{"id":"1091"},{"id":"1092"},{"id":"1093"}]},"id":"1019","type":"DatetimeTicker"},{"attributes":{"axis":{"id":"1018"},"grid_line_color":null,"ticker":null},"id":"1021","type":"Grid"},{"attributes":{},"id":"1048","type":"Selection"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1062"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_predicted_0","@{y_test_predicted_0}"]]},"id":"1007","type":"HoverTool"},{"attributes":{},"id":"1027","type":"PanTool"},{"attributes":{},"id":"1028","type":"WheelZoomTool"},{"attributes":{"axis":{"id":"1022"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"1025","type":"Grid"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test"}},"id":"1055","type":"Line"},{"attributes":{},"id":"1023","type":"BasicTicker"},{"attributes":{"axis_label":"y_test","formatter":{"id":"1044"},"major_label_policy":{"id":"1046"},"ticker":{"id":"1023"}},"id":"1022","type":"LinearAxis"},{"attributes":{"data_source":{"id":"1047"},"glyph":{"id":"1050"},"hover_glyph":null,"muted_glyph":{"id":"1052"},"nonselection_glyph":{"id":"1051"},"selection_glyph":{"id":"1055"},"view":{"id":"1054"}},"id":"1053","type":"GlyphRenderer"},{"attributes":{"mantissas":[1,2,5],"max_interval":500.0,"num_minor_ticks":0},"id":"1082","type":"AdaptiveTicker"},{"attributes":{},"id":"1026","type":"SaveTool"},{"attributes":{"base":60,"mantissas":[1,2,5,10,15,20,30],"max_interval":1800000.0,"min_interval":1000.0,"num_minor_ticks":0},"id":"1083","type":"AdaptiveTicker"},{"attributes":{"overlay":{"id":"1031"}},"id":"1029","type":"BoxZoomTool"},{"attributes":{"line_alpha":0.1,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test"}},"id":"1051","type":"Line"},{"attributes":{},"id":"1093","type":"YearsTicker"},{"attributes":{},"id":"1030","type":"ResetTool"},{"attributes":{"source":{"id":"1047"}},"id":"1054","type":"CDSView"},{"attributes":{"base":24,"mantissas":[1,2,4,6,8,12],"max_interval":43200000.0,"min_interval":3600000.0,"num_minor_ticks":0},"id":"1084","type":"AdaptiveTicker"},{"attributes":{"months":[0,1,2,3,4,5,6,7,8,9,10,11]},"id":"1089","type":"MonthsTicker"},{"attributes":{"source":{"id":"1056"}},"id":"1063","type":"CDSView"},{"attributes":{"days":[1,15]},"id":"1088","type":"DaysTicker"},{"attributes":{"days":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},"id":"1085","type":"DaysTicker"},{"attributes":{"days":[1,4,7,10,13,16,19,22,25,28]},"id":"1086","type":"DaysTicker"},{"attributes":{"days":[1,8,15,22]},"id":"1087","type":"DaysTicker"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"black"},"line_alpha":{"value":0.2},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1"}},"id":"1070","type":"Scatter"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"black"},"line_alpha":{"value":0.2},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0"}},"id":"1061","type":"Scatter"},{"attributes":{"months":[0,6]},"id":"1092","type":"MonthsTicker"},{"attributes":{"data_source":{"id":"1056"},"glyph":{"id":"1059"},"hover_glyph":null,"muted_glyph":{"id":"1061"},"nonselection_glyph":{"id":"1060"},"selection_glyph":{"id":"1064"},"view":{"id":"1063"}},"id":"1062","type":"GlyphRenderer"},{"attributes":{"months":[0,2,4,6,8,10]},"id":"1090","type":"MonthsTicker"},{"attributes":{},"id":"1066","type":"Selection"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"black"},"line_alpha":{"value":0.1},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0"}},"id":"1060","type":"Scatter"},{"attributes":{"months":[0,4,8]},"id":"1091","type":"MonthsTicker"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_predicted_1":{"__ndarray__":"AAAAAAAA+H8AAADAWw/fPwAAAMC3kN0/AAAAAPiT3D8AAADAGLndPwAAAAB2XN4/AAAAgDGN3T8AAAAA9gTdPwAAAEB3nNw/AAAAgFMq3T8AAACAeAfePwAAAABJJ98/AAAAADRt3z8AAAAAPnHePwAAAMAcOt4/AAAAQDVs3j8AAACAHtbdPwAAAAD+7d4/AAAAwBUl3z8AAADAoWvdPwAAAIAuK94/AAAAgLNl3z8AAAAAv8/ePwAAAICsst8/AAAAwNUL3z8AAABAY63ePwAAAEB0l94/AAAAoBMO4D8AAACAUazePwAAAACQNd8/AAAAwBSg4D8AAADASFjdPwAAAMC6ut4/AAAAIM524D8AAADABZHfPwAAAIDbCN4/AAAAwC8P4D8AAABAyJjePwAAAICzPOA/AAAAoHab4D8AAADAuSXgPwAAAEAijN0/AAAAYCli4T8AAACA1PvcPwAAAMBAEeA/AAAAQAdO4T8AAACALX3gPwAAAID2Dd8/AAAAAPFq4D8AAAAggMThPwAAACBvROM/AAAAAAsg4j8AAADAz3vhPwAAAICd5OE/AAAAID0n4z8AAAAALfriPwAAAKCnMOI/AAAAwNfE4z8AAABAidPhPwAAACCz6eI/AAAAAMCI4z8AAACg6OfhPwAAACA5nOQ/AAAAwEk54j8AAADgy3PjPwAAAABLCeM/AAAAgFMd5D8AAADAAs7iPwAAAEDW3uU/AAAAIIF54D8AAAAAndPkPwAAAAAPk+Q/AAAAoEB64j8AAADAgRHlPwAAAAC4xOI/AAAAwIdV4j8AAACAr2LmPwAAAADFlOI/AAAA4Bbt4j8AAACASX7iPwAAAIDyiOU/AAAAwPR+4z8AAABg5sPjPwAAAAAU1+I/AAAAQEay4z8AAAAAamPiPwAAACAH6+M/AAAAAIq04T8AAAAAZR7iPwAAAOAZ0eE/AAAAQKQR4j8AAAAg1w7jPwAAAAA2ceQ/AAAAwId75D8AAAAAl6vjPwAAAABDjuE/AAAAYBOg4T8AAACAVMnhPwAAAADDGeM/AAAAQAsI5D8AAABAiqrkPwAAAMBrCuI/AAAAoFsR4T8AAACAKZjhPwAAAAA/2eI/AAAAoGcb4z8AAADgU9jhPwAAAEAEc98/AAAAgMoY4T8AAADggh3iPwAAAKDLk+I/AAAAgL/P4T8AAAAAhufgPwAAAMBTx+A/AAAAADkU4T8AAACgRSjjPwAAAED5KOI/AAAAAFD94T8AAADgBU/iPwAAAOAqDeM/AAAAgDTz4j8AAACArejiPwAAAKAqV+I/AAAAAES94T8AAACgMO3hPwAAAABDteE/AAAAAMPM4j8AAACgRhHjPwAAAODUseI/","dtype":"float64","order":"little","shape":[129]}},"selected":{"id":"1066"},"selection_policy":{"id":"1098"}},"id":"1065","type":"ColumnDataSource"},{"attributes":{"active_multi":null,"tools":[{"id":"1006"},{"id":"1007"},{"id":"1008"},{"id":"1026"},{"id":"1027"},{"id":"1028"},{"id":"1029"},{"id":"1030"}]},"id":"1032","type":"Toolbar"},{"attributes":{"fill_color":{"value":"black"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0"}},"id":"1059","type":"Scatter"},{"attributes":{"angle":{"value":0.0},"fill_alpha":{"value":1.0},"fill_color":{"value":"black"},"hatch_alpha":{"value":1.0},"hatch_color":{"value":"black"},"hatch_scale":{"value":12.0},"hatch_weight":{"value":1.0},"line_alpha":{"value":1.0},"line_cap":{"value":"butt"},"line_color":{"value":"black"},"line_dash":{"value":[]},"line_dash_offset":{"value":0},"line_join":{"value":"bevel"},"line_width":{"value":1},"marker":{"value":"circle"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0"}},"id":"1064","type":"Scatter"},{"attributes":{"data_source":{"id":"1065"},"glyph":{"id":"1068"},"hover_glyph":null,"muted_glyph":{"id":"1070"},"nonselection_glyph":{"id":"1069"},"selection_glyph":{"id":"1073"},"view":{"id":"1072"}},"id":"1071","type":"GlyphRenderer"},{"attributes":{},"id":"1057","type":"Selection"},{"attributes":{"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"line_alpha":{"value":0.5},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1"}},"id":"1068","type":"Scatter"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_predicted_0":{"__ndarray__":"+GjkPlL36T6dRdg+0mXPPnIc1j4kBt4+KSPUPqNC0D7emck+J+POPmDj2z5r/eU+rvfmPqEk3D4jhtc+UKfePpQk0j6AmNw+DBTkPiBb0D580NQ+bgnjPhNw3T5rsOg+emDfPhqu2z595ds+FLfyPjAR5z5kw+M+IDcCP5MY0D5k7OE+yCwAP8eu7D4+JOc+J2H/Phym6j4txQI/qCMDPwviAT8Xw+A+faAVP9s02D43RAE/ZYwLP/37Az/QDPw+VKEHPwoUCz+nWx8/4HwZP4UOED+uCxA/T/0fP6pxHT/ORg4/tOYmP4dyCj/++Rc/zzUgP9DtBD/DrjA/V6wMP12uIz+KnRk/PY0nP5BtDT8QrUA/3Q3wPrAxKT/cCi4/ZNYEPxJXLz+pvBE/Pw/2Pvi/MD9wswI/B1kEPzffBT/K0h8/aUUbP9rlGj8ktxE/mtYjP0TlEz84by0/gUsQP6wJHz8Ghgo/dGUMP3zWCT+SFhc/sm8WPw/AFD9PmwE/7loAP5uv9j6mcwk/0q0KP1RgBj+xwAE/8IL9PlDW/T6ifg4/QqQOP1T/Bz/SWuo+1pQGP3uvBz/UXQ0/ptwCP7j0/D7weAA/qqT9Pqw3Fz8z4QM/Ss0BP44JBz8TvhA/KOwIP1siCj/aRAg/+vcDP9jhBj+1VQI/y6ENP5pHDj9bsQo/","dtype":"float32","order":"little","shape":[129]}},"selected":{"id":"1057"},"selection_policy":{"id":"1096"}},"id":"1056","type":"ColumnDataSource"},{"attributes":{"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"line_alpha":{"value":0.5},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1"}},"id":"1069","type":"Scatter"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1031","type":"BoxAnnotation"},{"attributes":{"source":{"id":"1065"}},"id":"1072","type":"CDSView"},{"attributes":{},"id":"1094","type":"UnionRenderers"},{"attributes":{"angle":{"value":0.0},"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"hatch_alpha":{"value":1.0},"hatch_color":{"value":"black"},"hatch_scale":{"value":12.0},"hatch_weight":{"value":1.0},"line_alpha":{"value":0.5},"line_cap":{"value":"butt"},"line_color":{"value":"black"},"line_dash":{"value":[]},"line_dash_offset":{"value":0},"line_join":{"value":"bevel"},"line_width":{"value":1},"marker":{"value":"circle"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1"}},"id":"1073","type":"Scatter"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test":{"__ndarray__":"OksybbMk4z/OOwzxvMPgP57rGMW5juE/josc3bjI4T92+yGBtx/iP5TY2kmJrd0/3gpI/a2A5D9eOymxtZPiP46LHN24yOE/phsXObpx4T+2qxGVuxrhP7arEZW7GuE/dvshgbcf4j+U2NpJia3dP4IrIPW3AuI/2psI2b2J4D9E+OzBhM/ePxqLOZ2xmOM//HjBoY8X3D+CKyD1twLiP/pbAam/FeA/7BjFuY5R3D9kp1+ky0/bP4R43mGI590/bLjlkYZb3j/aMmY62A3hP/z//////98/josc3bjI4T/8OYDxnwPYP3b7IYG3H+I/dBjieYch3j8sOPTxgkPfP9qbCNm9ieA/bssjDbc84j8k2PcJgn3fP0arLlW06uI/dBjieYch3j8MmnzZoMnXP/wX/zmA8d8/jDmdsZjT2T/u+wTBvk/gP9KqSxWtuuQ/nusYxbmO4T8MmnzZoMnXP+z7BMG+T9A/lMDbDwm83T/6WwGpvxXgP0Tg7YcE3t4/grcfEnj74T8uGzT5skHjP/IrAzW/MuA/gisg9bcC4j/OOwzxvMPgP6YbFzm6ceE/nusYxbmO4T+Kcx2jONfhPy4bNPmyQeM/7vsEwb5P4D88mPDZgwnfP/wX/zmA8d8/bLjlkYZb3j88mPDZgwnfP2x5pOGWR9o/XFjpqYWV3j/yKwM1vzLgP4ZbHmm45eE/1BmLOZ2x2D8E2b2JkN3bP9x5hyGed9g/fNmgyZcN2j+8+M8BjP/cP+wYxbmOUdw/hspdjajc5T+6GlG5qxHlP2JrJyW2duI/qksVrbpU4T/mOkZxrmPkPxZbOymxteM/ZBmo+ZWB2j/C2w8JvP3gPzrXMYpzHeM/5jpGca5j5D8u9h7tYu/hP57rGMW5juE/wgAlFQxQ4j/SwW6IckHsPworPbWw0uM/wkpPLaz05D/CSk8trPTkP4ImXzZo8uU/HqM41zGK4z8eozjXMYrjP/6RnKLKc+Q//v//////7z/6skGTLxvkPy72Hu1i7+E/Gh5Vb5i/4D92+yGBtx/iP+72QwJvP+Q/DlBSwQAl5T/2+PuP5BTlP4IrIPW3AuI/8isDNb8y4D9Ks5ouEGLnPwZqfmWg5uc/UgsrPbWw4j9uPyTw9kPiP55aWOmpheU/6l9bff615T+GTSzQLRroPwYm8dIKvek/YqWnFlZ66j+e6xjFuY7hP6qsYjgggOs/Glgy+NZ66D8KdWfNUHfmP6aEudef7eA/Lhs0+bJB4z8aizmdsZjjP8JKTy2s9OQ/Jqeo8hw15T/OLRpYMvjmP5bmzOITeec/Lhs0+bJB4z9uyyMNtzziP6aEudef7eA/ygsOfbzg4D8+ezDhswfjP147KbG1k+I/","dtype":"float64","order":"little","shape":[129]}},"selected":{"id":"1048"},"selection_policy":{"id":"1094"}},"id":"1047","type":"ColumnDataSource"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer01877","sizing_mode":"stretch_width"},"id":"1308","type":"Spacer"},{"attributes":{},"id":"1096","type":"UnionRenderers"}],"root_ids":["1002"]},"title":"Bokeh Application","version":"2.3.3"}};
    var render_items = [{"docid":"01fe59bb-f90e-4bed-96c7-ca0dd762c76c","root_ids":["1002"],"roots":{"1002":"21ca4dd2-f5e5-42a4-8159-59205a50d0a1"}}];
    root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 25, root)
  }
})(window);</script>




```python
# load the scaler

target_scaler = joblib.load(Path('c:/projects/nrel-presentation/models/target_scaler.save'))
```


```python
# Unscale the predicted values
Results['y_test_unscaled'] = target_scaler.inverse_transform(Results['y_test'].values.reshape(-1, 1))
Results['y_test_predicted_0_unscaled'] = target_scaler.inverse_transform(Results['y_test_predicted_0'].values.reshape(-1, 1))
Results['y_test_predicted_1_unscaled'] = target_scaler.inverse_transform(Results['y_test_predicted_1'].values.reshape(-1, 1))
```


```python
Results
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_test</th>
      <th>y_test_predicted_0</th>
      <th>y_test_predicted_1</th>
      <th>y_test_unscaled</th>
      <th>y_test_predicted_0_unscaled</th>
      <th>y_test_predicted_1_unscaled</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-30 11:10:00</th>
      <td>0.598230</td>
      <td>0.446113</td>
      <td>NaN</td>
      <td>69.400000</td>
      <td>65.102699</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2021-10-30 11:20:00</th>
      <td>0.523894</td>
      <td>0.456965</td>
      <td>0.485312</td>
      <td>67.300000</td>
      <td>65.409256</td>
      <td>66.210075</td>
    </tr>
    <tr>
      <th>2021-10-30 11:30:00</th>
      <td>0.548673</td>
      <td>0.422406</td>
      <td>0.461958</td>
      <td>68.000000</td>
      <td>64.432976</td>
      <td>65.550310</td>
    </tr>
    <tr>
      <th>2021-10-30 11:40:00</th>
      <td>0.555752</td>
      <td>0.405074</td>
      <td>0.446531</td>
      <td>68.200000</td>
      <td>63.943329</td>
      <td>65.114509</td>
    </tr>
    <tr>
      <th>2021-10-30 11:50:00</th>
      <td>0.566372</td>
      <td>0.418186</td>
      <td>0.464422</td>
      <td>68.500000</td>
      <td>64.313744</td>
      <td>65.619933</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-10-31 07:50:00</th>
      <td>0.569912</td>
      <td>0.526884</td>
      <td>0.560204</td>
      <td>68.600000</td>
      <td>67.384460</td>
      <td>68.325759</td>
    </tr>
    <tr>
      <th>2021-10-31 08:00:00</th>
      <td>0.529007</td>
      <td>0.509120</td>
      <td>0.553377</td>
      <td>67.444444</td>
      <td>66.882645</td>
      <td>68.132891</td>
    </tr>
    <tr>
      <th>2021-10-31 08:10:00</th>
      <td>0.527434</td>
      <td>0.553250</td>
      <td>0.587495</td>
      <td>67.400000</td>
      <td>68.129311</td>
      <td>69.096743</td>
    </tr>
    <tr>
      <th>2021-10-31 08:20:00</th>
      <td>0.594690</td>
      <td>0.555780</td>
      <td>0.595859</td>
      <td>69.300000</td>
      <td>68.200790</td>
      <td>69.333013</td>
    </tr>
    <tr>
      <th>2021-10-31 08:30:00</th>
      <td>0.580531</td>
      <td>0.541769</td>
      <td>0.584208</td>
      <td>68.900000</td>
      <td>67.804970</td>
      <td>69.003875</td>
    </tr>
  </tbody>
</table>
<p>129 rows × 6 columns</p>
</div>




```python
line_plot = Results.hvplot.line(y='y_test_unscaled', label='observed')
scatter_plot0 = Results.hvplot.scatter(y='y_test_predicted_0_unscaled', label='predicted (t + 10min)').opts(color='black', marker='o')
scatter_plot1 = Results.hvplot.scatter(y='y_test_predicted_1_unscaled', label='predicted (t + 20min)').opts(color='black', marker='o', alpha=0.5)

(line_plot * scatter_plot0 * scatter_plot1).opts(title = 'Vehicle Speed',
                                                 xlabel = 'Date',
                                                 ylabel = 'Vehicle Speed (mph)',
                                                 ylim = (55, 85),
                                                 legend_position = 'top_left',
                                                 width = 600,
                                                 height = 400)
```






<div id='1440'>





  <div class="bk-root" id="507a3866-5280-4924-9750-ac2849d07eea" data-root-id="1440"></div>
</div>
<script type="application/javascript">(function(root) {
  function embed_document(root) {
    var docs_json = {"2ee82e6a-f705-4356-879e-3cd1861b05a0":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{},"id":"1466","type":"WheelZoomTool"},{"attributes":{"data_source":{"id":"1552"},"glyph":{"id":"1555"},"hover_glyph":null,"muted_glyph":{"id":"1557"},"nonselection_glyph":{"id":"1556"},"selection_glyph":{"id":"1587"},"view":{"id":"1559"}},"id":"1558","type":"GlyphRenderer"},{"attributes":{"label":{"value":"observed"},"renderers":[{"id":"1491"}]},"id":"1516","type":"LegendItem"},{"attributes":{"click_policy":"mute","items":[{"id":"1516"},{"id":"1550"},{"id":"1586"}],"location":"top_left"},"id":"1515","type":"Legend"},{"attributes":{"overlay":{"id":"1469"}},"id":"1467","type":"BoxZoomTool"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"black"},"line_alpha":{"value":0.2},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1_unscaled"}},"id":"1557","type":"Scatter"},{"attributes":{},"id":"1468","type":"ResetTool"},{"attributes":{"angle":{"value":0.0},"fill_alpha":{"value":1.0},"fill_color":{"value":"black"},"hatch_alpha":{"value":1.0},"hatch_color":{"value":"black"},"hatch_scale":{"value":12.0},"hatch_weight":{"value":1.0},"line_alpha":{"value":1.0},"line_cap":{"value":"butt"},"line_color":{"value":"black"},"line_dash":{"value":[]},"line_dash_offset":{"value":0},"line_join":{"value":"bevel"},"line_width":{"value":1},"marker":{"value":"circle"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"1551","type":"Scatter"},{"attributes":{"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"line_alpha":{"value":0.5},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1_unscaled"}},"id":"1555","type":"Scatter"},{"attributes":{},"id":"1553","type":"Selection"},{"attributes":{"active_multi":null,"tools":[{"id":"1444"},{"id":"1445"},{"id":"1446"},{"id":"1464"},{"id":"1465"},{"id":"1466"},{"id":"1467"},{"id":"1468"}]},"id":"1470","type":"Toolbar"},{"attributes":{"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"line_alpha":{"value":0.5},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1_unscaled"}},"id":"1556","type":"Scatter"},{"attributes":{"label":{"value":"predicted (t + 20min)"},"renderers":[{"id":"1558"}]},"id":"1586","type":"LegendItem"},{"attributes":{"source":{"id":"1552"}},"id":"1559","type":"CDSView"},{"attributes":{},"id":"1512","type":"YearsTicker"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1469","type":"BoxAnnotation"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"1517","type":"Line"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"black"},"line_alpha":{"value":0.2},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"1523","type":"Scatter"},{"attributes":{},"id":"1584","type":"UnionRenderers"},{"attributes":{"data_source":{"id":"1518"},"glyph":{"id":"1521"},"hover_glyph":null,"muted_glyph":{"id":"1523"},"nonselection_glyph":{"id":"1522"},"selection_glyph":{"id":"1551"},"view":{"id":"1525"}},"id":"1524","type":"GlyphRenderer"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_predicted_1_unscaled":{"__ndarray__":"AAAAAAAA+H8AAPDfcY1QQAAA8EY4Y1BAAAAAHlRHUEAAADD7rGdQQAAAgAW0eVBAAABgttRiUEAAAIAlzFNQQAAA0ChESFBAAADgtutXUEAAACAMU3BQQAAAQM4VkFBAAAAA/cyXUEAAAIAX/3tQQAAAMKzpdVBAAABQ4HB7UEAAAKDd4GpQQAAAgEfDiVBAAABwptePUEAAAHCZIF9QQAAAoOFDdFBAAADgDvmWUEAAAMDTbIZQQAAAIIl3n1BAAABwVg6NUEAAANAzooJQQAAAEJQ2gFBAAADQVBurUEAAAGD+g4JQQAAAACSpkVBAAABglFTLUEAAADAH/lxQQAAAsBsbhFBAAAAQfjjCUEAAAHDiwJtQQAAA4Dh6cFBAAADgCVqrUEAAABAZXIBQQAAAwJ1ltVBAAABQrk/KUEAAAOB+U7BQQAAAkMe2YlBAAACwISr2UEAAACAzylJQQAAAYMrOq1BAAACgmbjxUEAAAMCKoMNQQAAAoHNKjVBAAACAMJq/UEAAABBH3gtRQAAAkIaaYFFAAACAbRIgUUAAAOBZ0/tQQAAAwML0ElFAAACQ/ShaUUAAAIDuNlBRQAAA0P68I1FAAADgnfF8UUAAAKDKLw9RQAAAkAiUTFFAAAAAYK5vUUAAAFDXrhNRQAAAkJt6rFFAAADgxqQlUUAAAPB+DmtRQAAAgA2NU1FAAADA7XiQUUAAAGCbd0ZRQAAAIEmu81FAAACQ/9DCUEAAAIAmtLhRQAAAgM90qlFAAABQQ/szUUAAAOAiXcZRQAAAAJxqRFFAAADgdeArUUAAAMC7xxBSQAAAgHrVOVFAAABwjFNNUUAAAMA43zRRQAAAQIW54FFAAABgBIVtUUAAADBYvHxRQAAAAOp3SFFAAAAggdh4UUAAAADl8C5RQAAAkBJfhVFAAAAAdVgIUUAAAIBKtR9RQAAA8DWmDlFAAAAgwOQcUUAAAJB6xlRRQAAAAGv8olFAAADgdUOlUUAAAIDTXndRQAAAgMnl/1BAAACwRtQDUUAAAEAm7wxRQAAAgIkvV1FAAACge8aLUUAAACCDo69RQAAA4MdMG1FAAADQuFTkUEAAAMAoFQJRQAAAgGfySFFAAADQXoxXUUAAAPCCPhBRQAAAEDhxmFBAAABAsfjlUEAAAHBigx9RQAAA0HCeOVFAAADAw1kOUUAAAAATGdtQQAAA4Pv901BAAACAlPbkUEAAANBdY1pRQAAAoAILIlFAAAAAKGgYUUAAAPDLcCpRQAAAcPZnVFFAAABAFq1OUUAAAMBKWkxRQAAAUOg8LFFAAAAAgkUKUUAAAFA72RRRQAAAgEmBCFFAAACACTFGUUAAAFAWUFVRQAAAcHs/QFFA","dtype":"float64","order":"little","shape":[129]}},"selected":{"id":"1553"},"selection_policy":{"id":"1584"}},"id":"1552","type":"ColumnDataSource"},{"attributes":{"base":60,"mantissas":[1,2,5,10,15,20,30],"max_interval":1800000.0,"min_interval":1000.0,"num_minor_ticks":0},"id":"1502","type":"AdaptiveTicker"},{"attributes":{"fill_color":{"value":"black"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"1521","type":"Scatter"},{"attributes":{"mantissas":[1,2,5],"max_interval":500.0,"num_minor_ticks":0},"id":"1501","type":"AdaptiveTicker"},{"attributes":{"base":24,"mantissas":[1,2,4,6,8,12],"max_interval":43200000.0,"min_interval":3600000.0,"num_minor_ticks":0},"id":"1503","type":"AdaptiveTicker"},{"attributes":{},"id":"1519","type":"Selection"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1491"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_unscaled","@{y_test_unscaled}"]]},"id":"1444","type":"HoverTool"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"black"},"line_alpha":{"value":0.1},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"1522","type":"Scatter"},{"attributes":{"months":[0,1,2,3,4,5,6,7,8,9,10,11]},"id":"1508","type":"MonthsTicker"},{"attributes":{"days":[1,15]},"id":"1507","type":"DaysTicker"},{"attributes":{"axis_label":"Date","formatter":{"id":"1479"},"major_label_policy":{"id":"1481"},"ticker":{"id":"1457"}},"id":"1456","type":"DatetimeAxis"},{"attributes":{"label":{"value":"predicted (t + 10min)"},"renderers":[{"id":"1524"}]},"id":"1550","type":"LegendItem"},{"attributes":{"days":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},"id":"1504","type":"DaysTicker"},{"attributes":{"source":{"id":"1518"}},"id":"1525","type":"CDSView"},{"attributes":{"days":[1,4,7,10,13,16,19,22,25,28]},"id":"1505","type":"DaysTicker"},{"attributes":{"days":[1,8,15,22]},"id":"1506","type":"DaysTicker"},{"attributes":{},"id":"1454","type":"LinearScale"},{"attributes":{"months":[0,6]},"id":"1511","type":"MonthsTicker"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer02818","sizing_mode":"stretch_width"},"id":"1441","type":"Spacer"},{"attributes":{"months":[0,2,4,6,8,10]},"id":"1509","type":"MonthsTicker"},{"attributes":{"end":85,"reset_end":85,"reset_start":55,"start":55,"tags":[[["y_test_unscaled","y_test_unscaled",null]]]},"id":"1443","type":"Range1d"},{"attributes":{"angle":{"value":0.0},"fill_alpha":{"value":0.5},"fill_color":{"value":"black"},"hatch_alpha":{"value":1.0},"hatch_color":{"value":"black"},"hatch_scale":{"value":12.0},"hatch_weight":{"value":1.0},"line_alpha":{"value":0.5},"line_cap":{"value":"butt"},"line_color":{"value":"black"},"line_dash":{"value":[]},"line_dash_offset":{"value":0},"line_join":{"value":"bevel"},"line_width":{"value":1},"marker":{"value":"circle"},"size":{"value":5.477225575051661},"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_1_unscaled"}},"id":"1587","type":"Scatter"},{"attributes":{"months":[0,4,8]},"id":"1510","type":"MonthsTicker"},{"attributes":{"children":[{"id":"1441"},{"id":"1447"},{"id":"1822"}],"margin":[0,0,0,0],"name":"Row02814","tags":["embedded"]},"id":"1440","type":"Row"},{"attributes":{"text":"Vehicle Speed","text_color":"black","text_font_size":"12pt"},"id":"1448","type":"Title"},{"attributes":{},"id":"1479","type":"DatetimeTickFormatter"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1558"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_predicted_1_unscaled","@{y_test_predicted_1_unscaled}"]]},"id":"1446","type":"HoverTool"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_unscaled":{"__ndarray__":"mpmZmZlZUUAzMzMzM9NQQAAAAAAAAFFAzczMzMwMUUAAAAAAACBRQGZmZmZmZlBAZmZmZmamUUCamZmZmTlRQM3MzMzMDFFAmpmZmZn5UEBmZmZmZuZQQGZmZmZm5lBAAAAAAAAgUUBmZmZmZmZQQJqZmZmZGVFAZmZmZmbGUEBmZmZmZoZQQDMzMzMzc1FAmpmZmZk5UECamZmZmRlRQM3MzMzMrFBAAAAAAABAUEA5juM4jiNQQM3MzMzMbFBAmpmZmZl5UEA5juM4juNQQAAAAAAAqFBAzczMzMwMUUDMzMzMzIxPQAAAAAAAIFFAMzMzMzNzUEAzMzMzM5NQQGZmZmZmxlBAZmZmZmYmUUCamZmZmZlQQM3MzMzMTFFAMzMzMzNzUEAAAAAAAIBPQGZmZmZmplBANDMzMzPzT0CamZmZmblQQDMzMzMzs1FAAAAAAAAAUUAAAAAAAIBPQJqZmZmZ2U1AAAAAAABoUEDNzMzMzKxQQAAAAAAAiFBAAAAAAAAYUUAAAAAAAGBRQDMzMzMzs1BAmpmZmZkZUUAzMzMzM9NQQJqZmZmZ+VBAAAAAAAAAUUAAAAAAABBRQAAAAAAAYFFAmpmZmZm5UEDNzMzMzIxQQGZmZmZmplBAmpmZmZl5UEDNzMzMzIxQQGZmZmZmBlBAAAAAAACAUEAzMzMzM7NQQDMzMzMzE1FAMzMzMzOzT0AzMzMzMzNQQGVmZmZmpk9AAAAAAAAAUEAzMzMzM1NQQAAAAAAAQFBAMzMzMzPzUUBmZmZmZsZRQDMzMzMzM1FAMzMzMzPzUEAAAAAAAKBRQJqZmZmZeVFAzczMzMwMUEAAAAAAAOBQQAAAAAAAWFFAAAAAAACgUUBVVVVVVRVRQAAAAAAAAFFAq6qqqqoqUUDHcRzHcVxTQAAAAAAAgFFAAAAAAADAUUAAAAAAAMBRQAAAAAAA+FFAAAAAAABwUUAAAAAAAHBRQDmO4ziOo1FAAAAAAAAwVEAAAAAAAJBRQFVVVVVVFVFAJUmSJEnSUEAAAAAAACBRQAAAAAAAmFFAq6qqqqrKUUByHMdxHMdRQJqZmZmZGVFAMzMzMzOzUECSJEmSJElSQGZmZmZmZlJAAAAAAABAUUAAAAAAAChRQAAAAAAA4FFAq6qqqqrqUUAcx3Ecx3FSQOQ4juM4zlJAAAAAAAD4UkAAAAAAAABRQBzHcRzHMVNAchzHcRyHUkBVVVVVVRVSQMdxHMdx3FBAAAAAAABgUUAzMzMzM3NRQAAAAAAAwFFA5DiO4zjOUUAcx3EcxzFSQOQ4juM4TlJAAAAAAABgUUBmZmZmZiZRQMdxHMdx3FBAmpmZmZnZUEAzMzMzM1NRQJqZmZmZOVFA","dtype":"float64","order":"little","shape":[129]}},"selected":{"id":"1486"},"selection_policy":{"id":"1513"}},"id":"1485","type":"ColumnDataSource"},{"attributes":{},"id":"1513","type":"UnionRenderers"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer02819","sizing_mode":"stretch_width"},"id":"1822","type":"Spacer"},{"attributes":{"end":1635669000000.0,"reset_end":1635669000000.0,"reset_start":1635592200000.0,"start":1635592200000.0,"tags":[[["timestamp","timestamp",null]]]},"id":"1442","type":"Range1d"},{"attributes":{"axis":{"id":"1460"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"1463","type":"Grid"},{"attributes":{},"id":"1484","type":"AllLabels"},{"attributes":{"below":[{"id":"1456"}],"center":[{"id":"1459"},{"id":"1463"},{"id":"1515"}],"height":400,"left":[{"id":"1460"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"1491"},{"id":"1524"},{"id":"1558"}],"sizing_mode":"fixed","title":{"id":"1448"},"toolbar":{"id":"1470"},"x_range":{"id":"1442"},"x_scale":{"id":"1452"},"y_range":{"id":"1443"},"y_scale":{"id":"1454"}},"id":"1447","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1548","type":"UnionRenderers"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_predicted_0_unscaled":{"__ndarray__":"lTSCQorRgkKv3YBC+MV/QqOggEIugIFC4WiAQrb2f0J2fn5CIql/QtdDgUI3YYJC1XyCQgpLgUKOyIBC9pGBQoowgELUV4FCNyuCQhz8f0ICfIBCyg2CQp5vgUJ4rYJCZaaBQvY9gUITRIFCtMiDQqV/gkJQIoJCKr2FQm3tf0JW7oFC4kmFQkkeg0LAgYJCeC6FQtXkgkKE3IVCXvGFQmOqhUKHzYFC6wWKQtbbgEKOh4VCfMyHQh0hhkJq0IRCG++GQuyxh0K6K4xCD+CKQjTLiEKUyohCaE+MQpa/i0KhZohC69WNQkeOh0KtiopC4FuMQnxWhkKS/o9CCQyIQvsfjUJF54pCrPqNQq42iEIyhpNCiH2DQndXjkJlaY9CUVGGQriyj0IjKolCLyeEQl4CkEKa2IVCpjWGQsSLhkIGRoxC0USLQrsvi0LrKIlC3SiNQhmkiUIMR49CqtiIQqIZjEKVkodCZPyHQtZrh0J7WIpCpzOKQmPUiULHmoVCElSFQuE4hEIGVodCXZuHQkKohkIHo4VCs/mEQuYChULzcohCQXuIQtoDh0KF3IJC2bOGQjvyhkI1M4hCs+GFQgHqhEKxWoVCa/2EQslfikI0G4ZCz6WFQpzNhkLz8YhCHziHQpV8h0IyE4dCOyCGQtjEhkLqw4VCNUKIQs5miEIlnIdC","dtype":"float32","order":"little","shape":[129]}},"selected":{"id":"1519"},"selection_policy":{"id":"1548"}},"id":"1518","type":"ColumnDataSource"},{"attributes":{},"id":"1482","type":"BasicTickFormatter"},{"attributes":{},"id":"1452","type":"LinearScale"},{"attributes":{},"id":"1481","type":"AllLabels"},{"attributes":{"axis":{"id":"1456"},"grid_line_color":null,"ticker":null},"id":"1459","type":"Grid"},{"attributes":{"data_source":{"id":"1485"},"glyph":{"id":"1488"},"hover_glyph":null,"muted_glyph":{"id":"1490"},"nonselection_glyph":{"id":"1489"},"selection_glyph":{"id":"1517"},"view":{"id":"1492"}},"id":"1491","type":"GlyphRenderer"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"1524"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_predicted_0_unscaled","@{y_test_predicted_0_unscaled}"]]},"id":"1445","type":"HoverTool"},{"attributes":{"line_alpha":0.2,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"1490","type":"Line"},{"attributes":{"num_minor_ticks":5,"tickers":[{"id":"1501"},{"id":"1502"},{"id":"1503"},{"id":"1504"},{"id":"1505"},{"id":"1506"},{"id":"1507"},{"id":"1508"},{"id":"1509"},{"id":"1510"},{"id":"1511"},{"id":"1512"}]},"id":"1457","type":"DatetimeTicker"},{"attributes":{},"id":"1461","type":"BasicTicker"},{"attributes":{},"id":"1465","type":"PanTool"},{"attributes":{},"id":"1486","type":"Selection"},{"attributes":{},"id":"1464","type":"SaveTool"},{"attributes":{"line_alpha":0.1,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"1489","type":"Line"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"1488","type":"Line"},{"attributes":{"axis_label":"Vehicle Speed (mph)","formatter":{"id":"1482"},"major_label_policy":{"id":"1484"},"ticker":{"id":"1461"}},"id":"1460","type":"LinearAxis"},{"attributes":{"source":{"id":"1485"}},"id":"1492","type":"CDSView"}],"root_ids":["1440"]},"title":"Bokeh Application","version":"2.3.3"}};
    var render_items = [{"docid":"2ee82e6a-f705-4356-879e-3cd1861b05a0","root_ids":["1440"],"roots":{"1440":"507a3866-5280-4924-9750-ac2849d07eea"}}];
    root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 25, root)
  }
})(window);</script>




```python
line_plot = Results.hvplot.line(y='y_test_unscaled', label='observed')
scatter_plot0 = Results.hvplot.line(y='y_test_predicted_0_unscaled', label='predicted').opts(color='black')
#scatter_plot1 = Results.hvplot.scatter(y='y_test_predicted_1_unscaled').opts(color='black', marker='o', alpha=0.5)
table_plot = Results.hvplot.table(['timestamp', 'y_test_unscaled', 'y_test_predicted_0_unscaled'], width=400)
(line_plot * scatter_plot0).opts(title = 'Vehicle Speed',
                                                 xlabel = 'Date',
                                                 ylabel = 'Vehicle Speed (mph)',
                                                 ylim = (55, 85),
                                                 legend_position = 'top_left',
                                                 width = 600,
                                                 height = 400)
```






<div id='1954'>





  <div class="bk-root" id="680fdd30-bf17-424d-8772-4e80ef04ee5e" data-root-id="1954"></div>
</div>
<script type="application/javascript">(function(root) {
  function embed_document(root) {
    var docs_json = {"3efef8a2-2a52-41ca-aa85-15d28e2b2ccb":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{"days":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},"id":"2016","type":"DaysTicker"},{"attributes":{},"id":"1967","type":"LinearScale"},{"attributes":{"days":[1,4,7,10,13,16,19,22,25,28]},"id":"2017","type":"DaysTicker"},{"attributes":{"axis_label":"Date","formatter":{"id":"1991"},"major_label_policy":{"id":"1993"},"ticker":{"id":"1970"}},"id":"1969","type":"DatetimeAxis"},{"attributes":{"days":[1,8,15,22]},"id":"2018","type":"DaysTicker"},{"attributes":{"months":[0,1,2,3,4,5,6,7,8,9,10,11]},"id":"2020","type":"MonthsTicker"},{"attributes":{},"id":"1965","type":"LinearScale"},{"attributes":{"axis":{"id":"1969"},"grid_line_color":null,"ticker":null},"id":"1972","type":"Grid"},{"attributes":{"months":[0,6]},"id":"2023","type":"MonthsTicker"},{"attributes":{"axis_label":"Vehicle Speed (mph)","formatter":{"id":"1994"},"major_label_policy":{"id":"1996"},"ticker":{"id":"1974"}},"id":"1973","type":"LinearAxis"},{"attributes":{"months":[0,2,4,6,8,10]},"id":"2021","type":"MonthsTicker"},{"attributes":{"num_minor_ticks":5,"tickers":[{"id":"2013"},{"id":"2014"},{"id":"2015"},{"id":"2016"},{"id":"2017"},{"id":"2018"},{"id":"2019"},{"id":"2020"},{"id":"2021"},{"id":"2022"},{"id":"2023"},{"id":"2024"}]},"id":"1970","type":"DatetimeTicker"},{"attributes":{"days":[1,15]},"id":"2019","type":"DaysTicker"},{"attributes":{},"id":"1978","type":"PanTool"},{"attributes":{"months":[0,4,8]},"id":"2022","type":"MonthsTicker"},{"attributes":{"line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"2063","type":"Line"},{"attributes":{},"id":"2031","type":"Selection"},{"attributes":{"axis":{"id":"1973"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"1976","type":"Grid"},{"attributes":{"label":{"value":"predicted"},"renderers":[{"id":"2036"}]},"id":"2062","type":"LegendItem"},{"attributes":{},"id":"2024","type":"YearsTicker"},{"attributes":{},"id":"1974","type":"BasicTicker"},{"attributes":{},"id":"1979","type":"WheelZoomTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"2034","type":"Line"},{"attributes":{"line_alpha":0.2,"line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"2035","type":"Line"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_unscaled":{"__ndarray__":"mpmZmZlZUUAzMzMzM9NQQAAAAAAAAFFAzczMzMwMUUAAAAAAACBRQGZmZmZmZlBAZmZmZmamUUCamZmZmTlRQM3MzMzMDFFAmpmZmZn5UEBmZmZmZuZQQGZmZmZm5lBAAAAAAAAgUUBmZmZmZmZQQJqZmZmZGVFAZmZmZmbGUEBmZmZmZoZQQDMzMzMzc1FAmpmZmZk5UECamZmZmRlRQM3MzMzMrFBAAAAAAABAUEA5juM4jiNQQM3MzMzMbFBAmpmZmZl5UEA5juM4juNQQAAAAAAAqFBAzczMzMwMUUDMzMzMzIxPQAAAAAAAIFFAMzMzMzNzUEAzMzMzM5NQQGZmZmZmxlBAZmZmZmYmUUCamZmZmZlQQM3MzMzMTFFAMzMzMzNzUEAAAAAAAIBPQGZmZmZmplBANDMzMzPzT0CamZmZmblQQDMzMzMzs1FAAAAAAAAAUUAAAAAAAIBPQJqZmZmZ2U1AAAAAAABoUEDNzMzMzKxQQAAAAAAAiFBAAAAAAAAYUUAAAAAAAGBRQDMzMzMzs1BAmpmZmZkZUUAzMzMzM9NQQJqZmZmZ+VBAAAAAAAAAUUAAAAAAABBRQAAAAAAAYFFAmpmZmZm5UEDNzMzMzIxQQGZmZmZmplBAmpmZmZl5UEDNzMzMzIxQQGZmZmZmBlBAAAAAAACAUEAzMzMzM7NQQDMzMzMzE1FAMzMzMzOzT0AzMzMzMzNQQGVmZmZmpk9AAAAAAAAAUEAzMzMzM1NQQAAAAAAAQFBAMzMzMzPzUUBmZmZmZsZRQDMzMzMzM1FAMzMzMzPzUEAAAAAAAKBRQJqZmZmZeVFAzczMzMwMUEAAAAAAAOBQQAAAAAAAWFFAAAAAAACgUUBVVVVVVRVRQAAAAAAAAFFAq6qqqqoqUUDHcRzHcVxTQAAAAAAAgFFAAAAAAADAUUAAAAAAAMBRQAAAAAAA+FFAAAAAAABwUUAAAAAAAHBRQDmO4ziOo1FAAAAAAAAwVEAAAAAAAJBRQFVVVVVVFVFAJUmSJEnSUEAAAAAAACBRQAAAAAAAmFFAq6qqqqrKUUByHMdxHMdRQJqZmZmZGVFAMzMzMzOzUECSJEmSJElSQGZmZmZmZlJAAAAAAABAUUAAAAAAAChRQAAAAAAA4FFAq6qqqqrqUUAcx3Ecx3FSQOQ4juM4zlJAAAAAAAD4UkAAAAAAAABRQBzHcRzHMVNAchzHcRyHUkBVVVVVVRVSQMdxHMdx3FBAAAAAAABgUUAzMzMzM3NRQAAAAAAAwFFA5DiO4zjOUUAcx3EcxzFSQOQ4juM4TlJAAAAAAABgUUBmZmZmZiZRQMdxHMdx3FBAmpmZmZnZUEAzMzMzM1NRQJqZmZmZOVFA","dtype":"float64","order":"little","shape":[129]}},"selected":{"id":"1998"},"selection_policy":{"id":"2025"}},"id":"1997","type":"ColumnDataSource"},{"attributes":{},"id":"1977","type":"SaveTool"},{"attributes":{"source":{"id":"2030"}},"id":"2037","type":"CDSView"},{"attributes":{"children":[{"id":"1955"},{"id":"1960"},{"id":"2280"}],"margin":[0,0,0,0],"name":"Row03676","tags":["embedded"]},"id":"1954","type":"Row"},{"attributes":{"data_source":{"id":"2030"},"glyph":{"id":"2033"},"hover_glyph":null,"muted_glyph":{"id":"2035"},"nonselection_glyph":{"id":"2034"},"selection_glyph":{"id":"2063"},"view":{"id":"2037"}},"id":"2036","type":"GlyphRenderer"},{"attributes":{"overlay":{"id":"1982"}},"id":"1980","type":"BoxZoomTool"},{"attributes":{},"id":"1981","type":"ResetTool"},{"attributes":{"click_policy":"mute","items":[{"id":"2028"},{"id":"2062"}],"location":"top_left"},"id":"2027","type":"Legend"},{"attributes":{"line_alpha":0.2,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"2002","type":"Line"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer03680","sizing_mode":"stretch_width"},"id":"1955","type":"Spacer"},{"attributes":{"data_source":{"id":"1997"},"glyph":{"id":"2000"},"hover_glyph":null,"muted_glyph":{"id":"2002"},"nonselection_glyph":{"id":"2001"},"selection_glyph":{"id":"2029"},"view":{"id":"2004"}},"id":"2003","type":"GlyphRenderer"},{"attributes":{},"id":"2025","type":"UnionRenderers"},{"attributes":{},"id":"1991","type":"DatetimeTickFormatter"},{"attributes":{"source":{"id":"1997"}},"id":"2004","type":"CDSView"},{"attributes":{"text":"Vehicle Speed","text_color":"black","text_font_size":"12pt"},"id":"1961","type":"Title"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"2000","type":"Line"},{"attributes":{},"id":"1994","type":"BasicTickFormatter"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"2003"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_unscaled","@{y_test_unscaled}"]]},"id":"1958","type":"HoverTool"},{"attributes":{"callback":null,"formatters":{"@{timestamp}":"datetime"},"renderers":[{"id":"2036"}],"tags":["hv_created"],"tooltips":[["timestamp","@{timestamp}{%F %T}"],["y_test_predicted_0_unscaled","@{y_test_predicted_0_unscaled}"]]},"id":"1959","type":"HoverTool"},{"attributes":{"line_alpha":0.1,"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"2001","type":"Line"},{"attributes":{"line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_predicted_0_unscaled"}},"id":"2033","type":"Line"},{"attributes":{"data":{"timestamp":{"__ndarray__":"AAD0RQ7Nd0IAAHDYDs13QgAA7GoPzXdCAABo/Q/Nd0IAAOSPEM13QgAAYCIRzXdCAADctBHNd0IAAFhHEs13QgAA1NkSzXdCAABQbBPNd0IAAMz+E813QgAASJEUzXdCAADEIxXNd0IAAEC2Fc13QgAAvEgWzXdCAAA42xbNd0IAALRtF813QgAAMAAYzXdCAACskhjNd0IAACglGc13QgAApLcZzXdCAAAgShrNd0IAAJzcGs13QgAAGG8bzXdCAACUARzNd0IAABCUHM13QgAAjCYdzXdCAAAIuR3Nd0IAAIRLHs13QgAAAN4ezXdCAAB8cB/Nd0IAAPgCIM13QgAAdJUgzXdCAADwJyHNd0IAAGy6Ic13QgAA6EwizXdCAABk3yLNd0IAAOBxI813QgAAXAQkzXdCAADYliTNd0IAAFQpJc13QgAA0LslzXdCAABMTibNd0IAAMjgJs13QgAARHMnzXdCAADABSjNd0IAADyYKM13QgAAuCopzXdCAAA0vSnNd0IAALBPKs13QgAALOIqzXdCAACodCvNd0IAACQHLM13QgAAoJkszXdCAAAcLC3Nd0IAAJi+Lc13QgAAFFEuzXdCAACQ4y7Nd0IAAAx2L813QgAAiAgwzXdCAAAEmzDNd0IAAIAtMc13QgAA/L8xzXdCAAB4UjLNd0IAAPTkMs13QgAAcHczzXdCAADsCTTNd0IAAGicNM13QgAA5C41zXdCAABgwTXNd0IAANxTNs13QgAAWOY2zXdCAADUeDfNd0IAAFALOM13QgAAzJ04zXdCAABIMDnNd0IAAMTCOc13QgAAQFU6zXdCAAC85zrNd0IAADh6O813QgAAtAw8zXdCAAAwnzzNd0IAAKwxPc13QgAAKMQ9zXdCAACkVj7Nd0IAACDpPs13QgAAnHs/zXdCAAAYDkDNd0IAAJSgQM13QgAAEDNBzXdCAACMxUHNd0IAAAhYQs13QgAAhOpCzXdCAAAAfUPNd0IAAHwPRM13QgAA+KFEzXdCAAB0NEXNd0IAAPDGRc13QgAAbFlGzXdCAADo60bNd0IAAGR+R813QgAA4BBIzXdCAABco0jNd0IAANg1Sc13QgAAVMhJzXdCAADQWkrNd0IAAEztSs13QgAAyH9LzXdCAABEEkzNd0IAAMCkTM13QgAAPDdNzXdCAAC4yU3Nd0IAADRcTs13QgAAsO5OzXdCAAAsgU/Nd0IAAKgTUM13QgAAJKZQzXdCAACgOFHNd0IAABzLUc13QgAAmF1SzXdCAAAU8FLNd0IAAJCCU813QgAADBVUzXdCAACIp1TNd0IAAAQ6Vc13QgAAgMxVzXdCAAD8XlbNd0IAAHjxVs13QgAA9INXzXdC","dtype":"float64","order":"little","shape":[129]},"y_test_predicted_0_unscaled":{"__ndarray__":"lTSCQorRgkKv3YBC+MV/QqOggEIugIFC4WiAQrb2f0J2fn5CIql/QtdDgUI3YYJC1XyCQgpLgUKOyIBC9pGBQoowgELUV4FCNyuCQhz8f0ICfIBCyg2CQp5vgUJ4rYJCZaaBQvY9gUITRIFCtMiDQqV/gkJQIoJCKr2FQm3tf0JW7oFC4kmFQkkeg0LAgYJCeC6FQtXkgkKE3IVCXvGFQmOqhUKHzYFC6wWKQtbbgEKOh4VCfMyHQh0hhkJq0IRCG++GQuyxh0K6K4xCD+CKQjTLiEKUyohCaE+MQpa/i0KhZohC69WNQkeOh0KtiopC4FuMQnxWhkKS/o9CCQyIQvsfjUJF54pCrPqNQq42iEIyhpNCiH2DQndXjkJlaY9CUVGGQriyj0IjKolCLyeEQl4CkEKa2IVCpjWGQsSLhkIGRoxC0USLQrsvi0LrKIlC3SiNQhmkiUIMR49CqtiIQqIZjEKVkodCZPyHQtZrh0J7WIpCpzOKQmPUiULHmoVCElSFQuE4hEIGVodCXZuHQkKohkIHo4VCs/mEQuYChULzcohCQXuIQtoDh0KF3IJC2bOGQjvyhkI1M4hCs+GFQgHqhEKxWoVCa/2EQslfikI0G4ZCz6WFQpzNhkLz8YhCHziHQpV8h0IyE4dCOyCGQtjEhkLqw4VCNUKIQs5miEIlnIdC","dtype":"float32","order":"little","shape":[129]}},"selected":{"id":"2031"},"selection_policy":{"id":"2060"}},"id":"2030","type":"ColumnDataSource"},{"attributes":{},"id":"1996","type":"AllLabels"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer03681","sizing_mode":"stretch_width"},"id":"2280","type":"Spacer"},{"attributes":{"below":[{"id":"1969"}],"center":[{"id":"1972"},{"id":"1976"},{"id":"2027"}],"height":400,"left":[{"id":"1973"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"2003"},{"id":"2036"}],"sizing_mode":"fixed","title":{"id":"1961"},"toolbar":{"id":"1983"},"x_range":{"id":"1956"},"x_scale":{"id":"1965"},"y_range":{"id":"1957"},"y_scale":{"id":"1967"}},"id":"1960","subtype":"Figure","type":"Plot"},{"attributes":{"mantissas":[1,2,5],"max_interval":500.0,"num_minor_ticks":0},"id":"2013","type":"AdaptiveTicker"},{"attributes":{},"id":"1998","type":"Selection"},{"attributes":{},"id":"1993","type":"AllLabels"},{"attributes":{},"id":"2060","type":"UnionRenderers"},{"attributes":{"base":60,"mantissas":[1,2,5,10,15,20,30],"max_interval":1800000.0,"min_interval":1000.0,"num_minor_ticks":0},"id":"2014","type":"AdaptiveTicker"},{"attributes":{"end":85,"reset_end":85,"reset_start":55,"start":55,"tags":[[["y_test_unscaled","y_test_unscaled",null]]]},"id":"1957","type":"Range1d"},{"attributes":{"line_color":"#30a2da","line_width":2,"x":{"field":"timestamp"},"y":{"field":"y_test_unscaled"}},"id":"2029","type":"Line"},{"attributes":{"end":1635669000000.0,"reset_end":1635669000000.0,"reset_start":1635592200000.0,"start":1635592200000.0,"tags":[[["timestamp","timestamp",null]]]},"id":"1956","type":"Range1d"},{"attributes":{"base":24,"mantissas":[1,2,4,6,8,12],"max_interval":43200000.0,"min_interval":3600000.0,"num_minor_ticks":0},"id":"2015","type":"AdaptiveTicker"},{"attributes":{"label":{"value":"observed"},"renderers":[{"id":"2003"}]},"id":"2028","type":"LegendItem"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1982","type":"BoxAnnotation"},{"attributes":{"active_multi":null,"tools":[{"id":"1958"},{"id":"1959"},{"id":"1977"},{"id":"1978"},{"id":"1979"},{"id":"1980"},{"id":"1981"}]},"id":"1983","type":"Toolbar"}],"root_ids":["1954"]},"title":"Bokeh Application","version":"2.3.3"}};
    var render_items = [{"docid":"3efef8a2-2a52-41ca-aa85-15d28e2b2ccb","root_ids":["1954"],"roots":{"1954":"680fdd30-bf17-424d-8772-4e80ef04ee5e"}}];
    root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 25, root)
  }
})(window);</script>



# Error


```python
errors_0 = np.abs(Results['y_test_unscaled'] - Results['y_test_predicted_0_unscaled']).values
errors_1 = np.abs(Results['y_test_unscaled'] - Results['y_test_predicted_1_unscaled']).values
```


```python
mae = np.nanmean(np.concatenate((errors_0, errors_1)))
```


```python
print('MAE: {:.2f} mph'.format(mae))
```

    MAE: 2.57 mph
    


```python
LSTMmodel.summary()
```

    Model: "sequential"
    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    lstm (LSTM)                  (None, 6, 96)             43392     
    _________________________________________________________________
    lstm_1 (LSTM)                (None, 6, 96)             74112     
    _________________________________________________________________
    lstm_2 (LSTM)                (None, 6, 96)             74112     
    _________________________________________________________________
    lstm_3 (LSTM)                (None, 96)                74112     
    _________________________________________________________________
    dense (Dense)                (None, 2)                 194       
    =================================================================
    Total params: 265,922
    Trainable params: 265,922
    Non-trainable params: 0
    _________________________________________________________________
    


```python

```
